# REST 原则

本章将尝试定义REST背后的概念，并解释使服务RESTful的原因。

REST通常与根据HTTP方法执行不同操作相混淆，同时使用的不仅仅是GET和POST方法。 这充其量是错误的。

我们将首先尝试定义REST，并将在HTTP和Web的上下文中查看它的含义。 有关REST的更深入的解释，您可以阅读[Roy T. Fielding](https://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm)的论文，因为它可以很好地解释它的来源和实现目标。

## REST 架构

REST是一种 client-server 架构。客户端和服务器都有一组不同的问题。服务器存储和/或操纵信息并使其以有效的方式提供给用户。客户端获取该信息并将其显示给用户和/或使用它来执行后续的信息请求。这种关注点分离允许客户端和服务器独立发展，因为它只需要接口保持不变。

REST是无状态的。这意味着客户端和服务器之间的通信始终包含执行请求所需的所有信息。服务器中没有会话状态，它完全保留在客户端。如果对资源的访问需要身份验证，则客户端需要对每个请求进行身份验证。

REST是可缓存的。客户端，服务器和任何中间组件都可以缓存资源以提高性能。

REST在组件之间提供统一的接口。这简化了体系结构，因为所有组件遵循相同的规则来相互通信。它还使您更容易理解系统的不同组件之间的交互。实现这一目标需要许多限制。本章的其余部分将介绍它们。

REST是一个分层系统。单个组件无法超越与其交互的直接层。这意味着连接到中间组件（如代理）的客户端不知道除了什么之外。这允许组件独立并因此易于更换或扩展。

REST可选择按需提供代码。可以下载代码以扩展客户端功能。这是可选的，但是因为客户端可能无法下载或运行此代码，因此REST组件不能依赖它执行。

## 资源和资源标识符

资源是一种抽象概念。在REST系统中，任何可以命名的信息都可以是资源。这包括文档，图像，资源集合和任何其他信息。任何可以作为超文本链接的目标的信息都可以是资源。

资源是到一组实体的概念映射。这组实体随着时间的推移而发展;资源没有。例如，资源可以映射到“过去一个月登录过的用户”，另一个映射到“所有用户”。在某个时间点，他们可能会映射到同一组实体，因为所有用户都在过去一个月内登录。但他们仍然是不同的资源。类似地，如果最近没有人登录，则第一个资源可以映射到空集。无论它映射到哪个信息，该资源都存在。

资源由统一资源标识符标识，也称为URI。有时也可以使用国际化资源标识符或IRI，但这些可以直接转换为URI。

在实践中，我们将确定两种资源。各个资源映射到一个元素的集合，例如“用户Joe”。资源集合映射到一组0到N个元素，例如“所有用户”。

## 资源表示

资源的表示是与元数据相关联的字节序列。

元数据作为键值对列表出现，其中名称对应于定义值的结构和语义的标准。使用HTTP，元数据以请求或响应头的形式出现。标头的结构和语义在HTTP标准中得到了很好的定义。元数据包括表示元数据，资源元数据和控制数据。

表示元数据提供有关表示的信息，例如其媒体类型，上次修改的日期，甚至校验和。

资源元数据可以链接到相关资源或关于资源的其他表示的信息。

控制数据允许参数化请求或响应。例如，我们可能只想要返回的表示，如果它比我们在缓存中的表示更新。类似地，我们可能想要指示客户端应该如何缓存表示。这不仅限于缓存。例如，我们可能只想在我们第一次检索资源时未修改资源的新表示形式。

表示的数据格式也称为媒体类型。某些媒体类型旨在直接呈现给用户，而其他媒体类型则用于自动处理。媒体类型是REST架构的关键组件。

## 自我描述性的信息

消息必须是自描述的。 这意味着表示的数据格式必须始终带有其媒体类型（类似地，请求资源涉及选择返回的表示的媒体类型）。 如果要发送HTML，则必须通过发送带有表示的媒体类型来说它是HTML。 在HTTP中，这是使用内容类型标头完成的。

媒体类型通常是IANA注册的媒体类型，如text/html或image/png，但不一定是。 对于尊重此约束，确实有两件事是重要的：媒体类型已明确指定，并且发件人和收件人同意媒体类型所指的内容。

这意味着您可以创建自己的媒体类型，例如application/x-mine，只要您为它编写规范并且两个端点都同意它，那么约束就会受到尊重。

## 超媒体作为应用程序状态的引擎

最后一个约束通常是声称为RESTful的服务失败。与服务器的交互必须完全由超媒体驱动。客户端不需要任何先前的服务知识来使用它，除了入口点，当然还有对表示的媒体类型的基本理解，至少足以找到和识别超链接和链接关系。

举一个简单的例子，如果你的服务只适用于application/json媒体类型，那么就不能遵守这个约束（因为JSON中没有链接的概念），因此你的服务不是RESTful。大多数自称为REST服务的情况都是如此。

另一方面，如果您创建具有链接和链接关系概念的基于JSON的媒体类型，那么您的服务可能是RESTful。

尊重此约束意味着整个服务变得可自行发现，不仅是其中的资源，还包括您可以对其执行的操作。这使得客户端非常薄，因为不需要实现特定于服务的任何内容来对其进行操作。